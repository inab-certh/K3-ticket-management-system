<!-- templates/requests/request_list.html -->
{% extends "layouts/base.html" %}

{% block title %}Αιτήματα{% endblock %}


{% block content %}
<div class="py-4">
<nav aria-label="breadcrumb" class="d-none d-md-inline-block">
    <ol class="breadcrumb breadcrumb-dark breadcrumb-transparent">
      <li class="breadcrumb-item"><a href="/">Κ3</a></li>
      <li class="breadcrumb-item active" aria-current="page">Λίστα Αιτήσεων</li>
    </ol>
  </nav>
  <h2>Αιτήματα</h2>
  <form method="get" class="row g-2 mb-3">
    <div class="col">
      <input type="text" name="q" class="form-control" placeholder="Αναζήτηση επωνύμου" value="{{ request.GET.q }}">
    </div>
    <div class="col">
      <select name="status" class="form-select">
        <option value="">Όλες οι καταστάσεις</option>
        {% for val, name in requests.model.K3RequestStatus.choices %}
          <option value="{{ val }}" {% if request.GET.status == val %}selected{% endif %}>{{ name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col">
      <button type="submit" class="btn btn-primary">Φίλτρο</button>
    </div>
	<div class="col-auto ms-auto">
      <a href="{% url 'new_request' %}" class="btn btn-success">+ Νέο αίτημα</a>
    </div>
  </form>
  <table class="table table-hover">
    <thead>
      <tr>
        <th>ΔΟΜΗ</th>
        <th>Επωνυμο</th>
        <th>Ονομα</th>
        <th>Κατηγορια</th>
        <th>Εκβαση</th>
        <th>Ενεργειες</th>
      </tr>
    </thead>
    <tbody>
      {% for req in requests %}
      <tr onclick="window.location='{% url 'request_detail' req.id %}'" style="cursor:pointer">
        <td>{{ req.beneficiary.structure }}</td>
        <td>{{ req.beneficiary.last_name }}</td>
        <td>{{ req.beneficiary.first_name }}</td>
        <td>{{ req.category }}</td>
        <td>{{ req.outcome }}</td>
        <td>{{ req.actions.count }}</td>
      </tr>
	  {% empty %}
      <tr>
        <td colspan="6" class="text-center text-muted">Δεν υπάρχουν αιτήματα.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% include "partials/pagination.html" %}
</div>
{% endblock %}
